# MathBox

A C++/DirectWrite-based class that parses and renders a minimal but comprehensive subset of $\LaTeX$ mathematical expressions directly to screen.

## Motivation
I was looking for a lightweight, open-source library to read and render TeX/LaTeX scripts directly on screen for Windows applications. While several excellent TeX processors exist (KaTeX, LuaLaTeX, pdfTeX, XeLaTeX) and [parsers that generate HTML+MathML](https://tex.stackexchange.com/questions/4223/what-parsers-for-latex-mathematics-exist-outside-of-the-tex-engines), none render $\TeX/\LaTeX$ scripts directly to screen with native Windows integration.

My goal is to provide basic selection and copy-to-clipboard support for rendered mathematical formulasâ€”functionality typically available only in some web-based TeX editors like Overleaf. This project aims to fill that gap by creating a **MathBox** class and demonstration application for native Windows mathematical typesetting.

## Concepts and References

This project requires deep understanding of $\TeX$ and OpenType font typesetting concepts. Here are the key references used throughout development:

- <a id="1">[[1]](https://visualmatheditor.equatheque.net/doc/texbook.pdf)</a> *"The $\TeX$book"* by Donald Knuth (1986) - the foundational reference
- <a id="2">[[2]](https://www.tug.org/TUGboat/tb27-1/tb86jackowski.pdf)</a> *"Appendix G Illuminated"* by BogusÅ‚aw Jackowski - practical TeX implementation guide
- <a id="3">[[3]](https://www.ntg.nl/maps/38/03.pdf)</a> *"OpenType Math Illuminated"* by Ulrik Vieth - OpenType MATH specification details
- <a id="4">[[4]](https://learn.microsoft.com/en-us/typography/opentype/spec/math)</a> *MATH - The Mathematical Typesetting Table* - Microsoft Typography documentation
- <a id="5">[[5]](https://w3c.github.io/mathml-core/)</a> *MathML Core Specifications* - W3C mathematical markup standards
- <a id="6">[[6]](https://fred-wang.github.io/MathFonts/LatinModern/)</a> *Latin Modern Math Font Glyphs* - comprehensive glyph documentation
- <a id="7">[[7]](https://github.com/ViktorQvarfordt/unicode-latex)</a> JSON mapping of LaTeX commands to **LMM** glyphs

## Font Data and Processing

The project uses the **Latin Modern Math** font (**LMM**), which is free and comprehensively documented [6]. The LMM font's MATH table content, combined with the LaTeX command mapping [](#7), is processed into the `LatinModernMathGlyphs.csv` table.

This CSV contains records ordered by font Glyph Indexes (as used in DirectWrite API) with the following fields:

- **Unicode_Codepoint** (uint32) - Unicode code point, if exists
- **Glyph_Name** (string) - Internal glyph name, if exists  
- **LaTeX_Command** (string) - LaTeX command (e.g., `\mathexclam` for '!' U+0021)
- **TeX_Atom_Class** (enum) - TeX classification: 0=Ord(default), 1=Op, 2=Bin, 3=Rel, etc.
- **TopAccentX** (int32) - Top accent vertical position, 0 if undefined
- **Italic_Correction** (int32) - Italic correction value, 0 if undefined

The table is generated by `LMMGlyphInfo.py` using the [fontTools](https://fonttools.readthedocs.io/) library and is essential for **MathBox** initialization.

## How to Build

**Prerequisites:**
- Visual Studio 2022 , but may work with earlier versions
- Windows 10/11 with DirectWrite support

**Build Instructions:**
1. Open the project in Visual Studio 2022
2. Select your target architecture (x64 recommended)
3. Build and run

*Note: The sample TeX boxes are currently built in `Main.cpp` -LaTeX script parsing coming soon.*

## Current Implementation Status

### âœ… Completed Features
- **Word (â‰ˆOrd)** - Text words and variable names
- **Radical** - Square roots with proper radicand positioning  
- **Fraction** - Fraction bar with numerator/denominator layout
- **Glue** - Variable horizontal spacing for proper mathematical typography
- **HBox** - Horizontal container with automatic spacing and baseline alignment(TODO: Badness)

### ðŸš§ In Progress
- **Indexed** - Items with superscript/subscript positioning
- **Text Mode** - support various (LatinModern) fonts of the 'text mode'

### ðŸ“‹ Planned Features
- **Accent** - Items with top accent glyphs
- **Over/Underbar** - Variable-size horizontal bars
- **Math Operators** - Min, max, sin, cos, gcd, etc. with optional limit support
- **Large Operators** - Integral, sum, product, union, intersection with limit support
- **Delimiters** - Variable-size brackets with optional middle delimiters
- **LaTeX Parser** - Complete control with automatic layout and selection support
- **MathBox Control** - Complete control with automatic layout and selection support

## Architecture

The project defines core interfaces and structures:
- `TexBox`      - Data-centric wrapper around basic TeX box
- `TexGlue`     - Data-centric wrapper around resizable horizontal spacing\glue
- `MathStyle`   - Wrapper around 4-way TeX math styles
- `MathItem`    - Abstract base for all mathematical elements\atoms
- `DWRenderInfo`- Structure with DirectWrite interfaces for rendering 

## Contributing

This project follows mathematical typesetting standards from:
- The TeXbook specifications
- OpenType MATH table requirements  
- MathML Core recommendations

Contributions are welcome! Please ensure any changes maintain compatibility with these standards.
TBD...

## License

Considering MIT ...
